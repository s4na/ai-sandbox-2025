<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>架空の画像編集ツール - PhotoEdit Helper</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            position: relative;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.95;
        }

        .help-button {
            position: absolute;
            top: 0;
            right: -100px;
            background: rgba(255, 255, 255, 0.2);
            border: 2px solid white;
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .help-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: scale(1.05);
        }

        .main-container {
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            padding: 30px;
            max-width: 1400px;
            width: 100%;
            position: relative;
        }

        .tutorial-overlay {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9999;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .tutorial-overlay.active {
            display: flex;
        }

        .tutorial-highlight {
            position: absolute;
            border: 3px solid #ffeb3b;
            border-radius: 8px;
            box-shadow: 0 0 0 9999px rgba(0, 0, 0, 0.5);
            z-index: 10000;
            pointer-events: none;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }

        .tutorial-tooltip {
            position: absolute;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            z-index: 10001;
            max-width: 350px;
        }

        .tutorial-tooltip h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .tutorial-tooltip p {
            color: #666;
            line-height: 1.6;
            margin-bottom: 15px;
        }

        .tutorial-buttons {
            display: flex;
            gap: 10px;
        }

        .tutorial-btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.2s;
        }

        .tutorial-btn-next {
            background: #667eea;
            color: white;
        }

        .tutorial-btn-next:hover {
            background: #764ba2;
        }

        .tutorial-btn-skip {
            background: #e0e0e0;
            color: #666;
        }

        .tutorial-btn-skip:hover {
            background: #d0d0d0;
        }

        .help-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 9998;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .help-modal.active {
            display: flex;
        }

        .help-content {
            background: white;
            border-radius: 15px;
            max-width: 900px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }

        .help-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            border-radius: 15px 15px 0 0;
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .help-header h2 {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .help-close {
            position: absolute;
            top: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            font-size: 24px;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            cursor: pointer;
            transition: all 0.2s;
        }

        .help-close:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: rotate(90deg);
        }

        .help-tabs {
            display: flex;
            background: #f5f5f5;
            border-bottom: 1px solid #ddd;
            position: sticky;
            top: 120px;
            z-index: 9;
        }

        .help-tab {
            flex: 1;
            padding: 15px;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            transition: all 0.2s;
            border-bottom: 3px solid transparent;
        }

        .help-tab:hover {
            background: #ebebeb;
        }

        .help-tab.active {
            color: #667eea;
            border-bottom-color: #667eea;
            background: white;
        }

        .help-body {
            padding: 30px;
        }

        .help-section {
            display: none;
        }

        .help-section.active {
            display: block;
            animation: fadeIn 0.3s;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .feature-card {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s;
            cursor: pointer;
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        }

        .feature-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .feature-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .feature-description {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }

        .shortcut-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
        }

        .shortcut-table th {
            background: #f5f5f5;
            padding: 12px;
            text-align: left;
            font-weight: 600;
            color: #333;
        }

        .shortcut-table td {
            padding: 12px;
            border-bottom: 1px solid #eee;
        }

        .shortcut-key {
            display: inline-block;
            padding: 4px 8px;
            background: #e0e0e0;
            border-radius: 4px;
            font-family: monospace;
            font-weight: 600;
        }

        .faq-item {
            margin-bottom: 20px;
            border: 1px solid #e0e0e0;
            border-radius: 8px;
            overflow: hidden;
        }

        .faq-question {
            width: 100%;
            text-align: left;
            padding: 15px 20px;
            background: #f8f9ff;
            border: none;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #333;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }

        .faq-question:hover {
            background: #e8ebff;
        }

        .faq-question.active {
            background: #667eea;
            color: white;
        }

        .faq-arrow {
            transition: transform 0.3s;
        }

        .faq-question.active .faq-arrow {
            transform: rotate(180deg);
        }

        .faq-answer {
            padding: 0 20px;
            max-height: 0;
            overflow: hidden;
            transition: all 0.3s;
        }

        .faq-answer.active {
            padding: 20px;
            max-height: 500px;
        }

        .upload-area {
            border: 3px dashed #667eea;
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            background: #f8f9ff;
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 30px;
            position: relative;
        }

        .upload-area.dragover {
            background: #e8ebff;
            border-color: #764ba2;
            transform: scale(1.02);
        }

        .upload-area.has-image {
            display: none;
        }

        .help-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            width: 30px;
            height: 30px;
            background: #667eea;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.2s;
        }

        .help-icon:hover {
            background: #764ba2;
            transform: scale(1.1);
        }

        .tooltip {
            position: absolute;
            background: #333;
            color: white;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
        }

        .tooltip.active {
            opacity: 1;
        }

        .tooltip::after {
            content: '';
            position: absolute;
            bottom: -5px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 5px solid #333;
        }

        .upload-icon {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 20px;
        }

        .upload-text {
            color: #666;
            font-size: 1.2rem;
            margin-bottom: 10px;
        }

        .upload-subtext {
            color: #999;
            font-size: 0.9rem;
        }

        input[type="file"] {
            display: none;
        }

        .editor-container {
            display: none;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            align-items: start;
        }

        .editor-container.active {
            display: grid;
        }

        .preview-container {
            background: #f5f5f5;
            border-radius: 10px;
            padding: 20px;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .canvas-wrapper {
            position: relative;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            border-radius: 8px;
            overflow: hidden;
        }

        canvas {
            display: block;
            max-width: 100%;
            height: auto;
        }

        .controls-panel {
            background: #f8f9ff;
            border-radius: 10px;
            padding: 25px;
            position: relative;
        }

        .control-group {
            margin-bottom: 25px;
            position: relative;
        }

        .control-label {
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
            font-size: 0.95rem;
        }

        .control-value {
            color: #667eea;
            font-weight: normal;
            font-size: 0.9rem;
        }

        .slider {
            width: 100%;
            height: 8px;
            border-radius: 4px;
            background: #ddd;
            outline: none;
            -webkit-appearance: none;
            cursor: pointer;
        }

        .slider::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
            transition: transform 0.2s;
        }

        .slider::-webkit-slider-thumb:hover {
            transform: scale(1.2);
        }

        .slider::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #667eea;
            cursor: pointer;
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
            transition: transform 0.2s;
        }

        .slider::-moz-range-thumb:hover {
            transform: scale(1.2);
        }

        .hue-slider {
            background: linear-gradient(to right, 
                hsl(0, 100%, 50%) 0%, 
                hsl(60, 100%, 50%) 17%, 
                hsl(120, 100%, 50%) 33%, 
                hsl(180, 100%, 50%) 50%, 
                hsl(240, 100%, 50%) 67%, 
                hsl(300, 100%, 50%) 83%, 
                hsl(360, 100%, 50%) 100%);
        }

        .action-buttons {
            display: flex;
            gap: 15px;
            margin-top: 30px;
            padding-top: 25px;
            border-top: 2px solid #e5e5e5;
        }

        .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #f5f5f5;
            color: #666;
        }

        .btn-secondary:hover {
            background: #e8e8e8;
        }

        .filter-presets {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-bottom: 25px;
        }

        .filter-btn {
            padding: 10px;
            background: #f5f5f5;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.2s;
            text-align: center;
            font-size: 12px;
            font-weight: 600;
            color: #666;
            position: relative;
        }

        .filter-btn:hover {
            background: #e8ebff;
            border-color: #667eea;
        }

        .filter-btn.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .onboarding-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 10002;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .onboarding-modal.active {
            display: flex;
        }

        .onboarding-content {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            text-align: center;
        }

        .onboarding-title {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 20px;
        }

        .onboarding-description {
            color: #666;
            line-height: 1.8;
            margin-bottom: 30px;
        }

        .onboarding-features {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 30px;
        }

        .onboarding-feature {
            display: flex;
            align-items: center;
            gap: 10px;
            text-align: left;
        }

        .onboarding-feature-icon {
            font-size: 1.5rem;
        }

        .onboarding-buttons {
            display: flex;
            gap: 15px;
            justify-content: center;
        }

        .floating-help {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 24px;
            cursor: pointer;
            box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            transition: all 0.3s;
            z-index: 1000;
        }

        .floating-help:hover {
            transform: scale(1.1);
            box-shadow: 0 15px 40px rgba(102, 126, 234, 0.5);
        }

        .floating-help.pulse {
            animation: helpPulse 2s infinite;
        }

        @keyframes helpPulse {
            0%, 100% { 
                box-shadow: 0 10px 30px rgba(102, 126, 234, 0.4);
            }
            50% { 
                box-shadow: 0 10px 50px rgba(102, 126, 234, 0.8);
            }
        }

        @media (max-width: 768px) {
            .editor-container {
                grid-template-columns: 1fr;
            }
            
            .header h1 {
                font-size: 1.8rem;
            }

            .help-button {
                position: static;
                margin-top: 20px;
            }

            .feature-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <!-- 初回起動時のオンボーディング -->
    <div class="onboarding-modal" id="onboardingModal">
        <div class="onboarding-content">
            <h2 class="onboarding-title">🎨 架空の PhotoEdit Helper へようこそ！</h2>
            <p class="onboarding-description">
                初めての方でも簡単に使える画像編集ツールです。<br>
                豊富なヘルプ機能とチュートリアルで、プロ並みの編集が可能になります。
            </p>
            <div class="onboarding-features">
                <div class="onboarding-feature">
                    <span class="onboarding-feature-icon">📚</span>
                    <span>詳細なヘルプガイド</span>
                </div>
                <div class="onboarding-feature">
                    <span class="onboarding-feature-icon">🎯</span>
                    <span>インタラクティブチュートリアル</span>
                </div>
                <div class="onboarding-feature">
                    <span class="onboarding-feature-icon">💡</span>
                    <span>ツールチップ表示</span>
                </div>
                <div class="onboarding-feature">
                    <span class="onboarding-feature-icon">⌨️</span>
                    <span>ショートカット一覧</span>
                </div>
            </div>
            <div class="onboarding-buttons">
                <button class="btn btn-primary" onclick="startTutorial()">チュートリアルを開始</button>
                <button class="btn btn-secondary" onclick="skipOnboarding()">スキップ</button>
            </div>
        </div>
    </div>

    <!-- チュートリアルオーバーレイ -->
    <div class="tutorial-overlay" id="tutorialOverlay"></div>
    <div class="tutorial-highlight" id="tutorialHighlight" style="display: none;"></div>
    <div class="tutorial-tooltip" id="tutorialTooltip" style="display: none;">
        <h3 id="tutorialTitle">ステップタイトル</h3>
        <p id="tutorialText">説明テキスト</p>
        <div class="tutorial-buttons">
            <button class="tutorial-btn tutorial-btn-skip" onclick="skipTutorial()">スキップ</button>
            <button class="tutorial-btn tutorial-btn-next" onclick="nextTutorialStep()">次へ</button>
        </div>
    </div>

    <!-- ヘルプモーダル -->
    <div class="help-modal" id="helpModal">
        <div class="help-content">
            <div class="help-header">
                <h2>📚 ヘルプ & ガイド</h2>
                <p>PhotoEdit Helper の使い方をマスターしましょう</p>
                <button class="help-close" onclick="closeHelp()">✕</button>
            </div>
            
            <div class="help-tabs">
                <button class="help-tab active" onclick="switchHelpTab('basics')">基本操作</button>
                <button class="help-tab" onclick="switchHelpTab('features')">機能一覧</button>
                <button class="help-tab" onclick="switchHelpTab('shortcuts')">ショートカット</button>
                <button class="help-tab" onclick="switchHelpTab('faq')">よくある質問</button>
            </div>

            <div class="help-body">
                <!-- 基本操作 -->
                <div class="help-section active" id="basics-section">
                    <h3>🚀 クイックスタートガイド</h3>
                    <div class="feature-grid">
                        <div class="feature-card" onclick="highlightFeature('upload')">
                            <div class="feature-icon">📸</div>
                            <div class="feature-title">1. 画像のアップロード</div>
                            <div class="feature-description">
                                ドラッグ&ドロップまたはクリックで画像を選択します。
                                対応形式：JPG, PNG, GIF, WebP
                            </div>
                        </div>
                        <div class="feature-card" onclick="highlightFeature('adjust')">
                            <div class="feature-icon">🎨</div>
                            <div class="feature-title">2. 色調整</div>
                            <div class="feature-description">
                                スライダーを動かして明度、彩度、色相などを調整します。
                                リアルタイムでプレビューが更新されます。
                            </div>
                        </div>
                        <div class="feature-card" onclick="highlightFeature('filter')">
                            <div class="feature-icon">✨</div>
                            <div class="feature-title">3. フィルター適用</div>
                            <div class="feature-description">
                                ワンクリックでプロ並みのフィルターを適用できます。
                                複数のプリセットから選択可能です。
                            </div>
                        </div>
                        <div class="feature-card" onclick="highlightFeature('download')">
                            <div class="feature-icon">💾</div>
                            <div class="feature-title">4. ダウンロード</div>
                            <div class="feature-description">
                                編集が完了したら、高品質な画像としてダウンロードできます。
                                元の解像度を維持します。
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 機能一覧 -->
                <div class="help-section" id="features-section">
                    <h3>🛠️ 利用可能な機能</h3>
                    <div class="feature-grid">
                        <div class="feature-card">
                            <div class="feature-icon">☀️</div>
                            <div class="feature-title">明度調整</div>
                            <div class="feature-description">
                                画像全体の明るさを0%〜200%の範囲で調整できます。
                                暗い写真を明るく、明るすぎる写真を適度に暗くできます。
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🌈</div>
                            <div class="feature-title">彩度調整</div>
                            <div class="feature-description">
                                色の鮮やかさを調整します。0%でグレースケール、
                                200%で最大の鮮やかさになります。
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎨</div>
                            <div class="feature-title">色相変更</div>
                            <div class="feature-description">
                                -180°〜180°の範囲で色相を回転させ、
                                画像全体の色調を変更できます。
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">⚡</div>
                            <div class="feature-title">コントラスト</div>
                            <div class="feature-description">
                                明暗の差を調整して、メリハリのある画像に仕上げます。
                                0%〜200%の範囲で調整可能です。
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🌡️</div>
                            <div class="feature-title">色温度</div>
                            <div class="feature-description">
                                暖色系・寒色系の調整ができます。
                                写真の雰囲気を大きく変えることができます。
                            </div>
                        </div>
                        <div class="feature-card">
                            <div class="feature-icon">🎭</div>
                            <div class="feature-title">フィルター</div>
                            <div class="feature-description">
                                セピア、グレースケール、ビンテージなど、
                                様々なフィルターをワンクリックで適用できます。
                            </div>
                        </div>
                    </div>
                </div>

                <!-- ショートカット -->
                <div class="help-section" id="shortcuts-section">
                    <h3>⌨️ キーボードショートカット</h3>
                    <table class="shortcut-table">
                        <thead>
                            <tr>
                                <th>操作</th>
                                <th>Windows/Linux</th>
                                <th>Mac</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>画像を開く</td>
                                <td><span class="shortcut-key">Ctrl</span> + <span class="shortcut-key">O</span></td>
                                <td><span class="shortcut-key">⌘</span> + <span class="shortcut-key">O</span></td>
                            </tr>
                            <tr>
                                <td>保存/ダウンロード</td>
                                <td><span class="shortcut-key">Ctrl</span> + <span class="shortcut-key">S</span></td>
                                <td><span class="shortcut-key">⌘</span> + <span class="shortcut-key">S</span></td>
                            </tr>
                            <tr>
                                <td>リセット</td>
                                <td><span class="shortcut-key">Ctrl</span> + <span class="shortcut-key">R</span></td>
                                <td><span class="shortcut-key">⌘</span> + <span class="shortcut-key">R</span></td>
                            </tr>
                            <tr>
                                <td>ヘルプを開く</td>
                                <td><span class="shortcut-key">F1</span> or <span class="shortcut-key">?</span></td>
                                <td><span class="shortcut-key">F1</span> or <span class="shortcut-key">?</span></td>
                            </tr>
                            <tr>
                                <td>フルスクリーン</td>
                                <td><span class="shortcut-key">F11</span></td>
                                <td><span class="shortcut-key">⌘</span> + <span class="shortcut-key">F</span></td>
                            </tr>
                        </tbody>
                    </table>
                    
                    <h4 style="margin-top: 30px;">💡 ヒント</h4>
                    <ul style="line-height: 1.8; color: #666;">
                        <li>スライダーをダブルクリックすると、デフォルト値にリセットされます</li>
                        <li>Shiftキーを押しながらスライダーを動かすと、細かい調整ができます</li>
                        <li>画像上で右クリックすると、コンテキストメニューが表示されます</li>
                    </ul>
                </div>

                <!-- FAQ -->
                <div class="help-section" id="faq-section">
                    <h3>❓ よくある質問</h3>
                    
                    <div class="faq-item">
                        <button class="faq-question" onclick="toggleFaq(this)">
                            <span>対応している画像形式は何ですか？</span>
                            <span class="faq-arrow">▼</span>
                        </button>
                        <div class="faq-answer">
                            JPG, JPEG, PNG, GIF, WebP, BMP形式に対応しています。
                            最大ファイルサイズは10MBまでです。高解像度の画像も処理可能ですが、
                            パフォーマンスを考慮して4000x4000ピクセル以下を推奨します。
                        </div>
                    </div>

                    <div class="faq-item">
                        <button class="faq-question" onclick="toggleFaq(this)">
                            <span>編集した画像の品質は落ちますか？</span>
                            <span class="faq-arrow">▼</span>
                        </button>
                        <div class="faq-answer">
                            編集処理は非破壊的に行われ、元の画像品質を可能な限り保持します。
                            ダウンロード時はPNG形式で保存されるため、圧縮による劣化はありません。
                            ただし、極端なフィルター適用時は若干の品質低下が生じる場合があります。
                        </div>
                    </div>

                    <div class="faq-item">
                        <button class="faq-question" onclick="toggleFaq(this)">
                            <span>編集内容を元に戻すことはできますか？</span>
                            <span class="faq-arrow">▼</span>
                        </button>
                        <div class="faq-answer">
                            はい、「リセット」ボタンをクリックするか、Ctrl+R（Mac: ⌘+R）を押すことで、
                            すべての編集を元に戻すことができます。個別のスライダーをダブルクリックすると、
                            その項目だけをデフォルト値に戻すこともできます。
                        </div>
                    </div>

                    <div class="faq-item">
                        <button class="faq-question" onclick="toggleFaq(this)">
                            <span>モバイルデバイスでも使用できますか？</span>
                            <span class="faq-arrow">▼</span>
                        </button>
                        <div class="faq-answer">
                            はい、レスポンシブデザインに対応しているため、スマートフォンやタブレットでも
                            使用可能です。ただし、大きな画像の処理にはPCの使用を推奨します。
                            タッチ操作にも対応しており、スライダーの調整も問題なく行えます。
                        </div>
                    </div>

                    <div class="faq-item">
                        <button class="faq-question" onclick="toggleFaq(this)">
                            <span>画像データは保存されますか？</span>
                            <span class="faq-arrow">▼</span>
                        </button>
                        <div class="faq-answer">
                            いいえ、このツールは完全にブラウザ上で動作し、画像データは一切サーバーに
                            送信されません。すべての処理はローカルで行われるため、プライバシーは
                            完全に保護されます。ブラウザを閉じると、すべてのデータは削除されます。
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- メインヘッダー -->
    <div class="header">
        <h1>🎨 架空の PhotoEdit Helper</h1>
        <p>初心者にも優しい、ヘルプ充実の画像編集ツール</p>
        <button class="help-button" onclick="openHelp()">❓ ヘルプ</button>
    </div>

    <!-- メインコンテナ -->
    <div class="main-container">
        <!-- アップロードエリア -->
        <div class="upload-area" id="uploadArea">
            <div class="help-icon" onclick="showUploadHelp(event)">?</div>
            <div class="tooltip" id="uploadTooltip">
                画像をドラッグ&ドロップするか、クリックして選択してください
            </div>
            <div class="upload-icon">📸</div>
            <div class="upload-text">画像をドラッグ&ドロップ</div>
            <div class="upload-subtext">または クリックして選択</div>
            <input type="file" id="fileInput" accept="image/*">
        </div>

        <!-- エディターコンテナ -->
        <div class="editor-container" id="editorContainer">
            <div class="preview-container">
                <div class="help-icon" onclick="showPreviewHelp(event)">?</div>
                <div class="tooltip" id="previewTooltip">
                    編集結果がリアルタイムで表示されます
                </div>
                <div class="canvas-wrapper">
                    <canvas id="canvas"></canvas>
                </div>
                <button class="btn btn-secondary" id="newImageBtn">別の画像を選択</button>
            </div>

            <div class="controls-panel">
                <div class="help-icon" onclick="showControlsHelp(event)">?</div>
                <div class="tooltip" id="controlsTooltip">
                    各スライダーで画像を調整できます
                </div>

                <!-- フィルタープリセット -->
                <div class="control-group">
                    <label class="control-label">
                        <span>🎭 フィルター</span>
                    </label>
                    <div class="filter-presets">
                        <button class="filter-btn active" data-filter="none">なし</button>
                        <button class="filter-btn" data-filter="grayscale">グレー</button>
                        <button class="filter-btn" data-filter="sepia">セピア</button>
                        <button class="filter-btn" data-filter="vintage">ビンテージ</button>
                        <button class="filter-btn" data-filter="cold">クール</button>
                        <button class="filter-btn" data-filter="warm">ウォーム</button>
                    </div>
                </div>

                <!-- 基本調整 -->
                <div class="control-group">
                    <label class="control-label">
                        <span>🎨 色相（Hue）</span>
                        <span class="control-value" id="hueValue">0°</span>
                    </label>
                    <input type="range" class="slider hue-slider" id="hueSlider" min="-180" max="180" value="0">
                </div>

                <div class="control-group">
                    <label class="control-label">
                        <span>🌈 彩度（Saturation）</span>
                        <span class="control-value" id="saturationValue">100%</span>
                    </label>
                    <input type="range" class="slider" id="saturationSlider" min="0" max="200" value="100">
                </div>

                <div class="control-group">
                    <label class="control-label">
                        <span>☀️ 明度（Brightness）</span>
                        <span class="control-value" id="brightnessValue">100%</span>
                    </label>
                    <input type="range" class="slider" id="brightnessSlider" min="0" max="200" value="100">
                </div>

                <div class="control-group">
                    <label class="control-label">
                        <span>⚡ コントラスト</span>
                        <span class="control-value" id="contrastValue">100%</span>
                    </label>
                    <input type="range" class="slider" id="contrastSlider" min="0" max="200" value="100">
                </div>

                <div class="control-group">
                    <label class="control-label">
                        <span>🌡️ 色温度</span>
                        <span class="control-value" id="temperatureValue">0</span>
                    </label>
                    <input type="range" class="slider" id="temperatureSlider" min="-100" max="100" value="0">
                </div>

                <div class="action-buttons">
                    <button class="btn btn-secondary" id="resetBtn">
                        <span class="help-icon" style="position: absolute; top: -10px; right: -10px;" onclick="showResetHelp(event)">?</span>
                        リセット
                    </button>
                    <button class="btn btn-primary" id="downloadBtn">
                        <span class="help-icon" style="position: absolute; top: -10px; right: -10px;" onclick="showDownloadHelp(event)">?</span>
                        ダウンロード
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- フローティングヘルプボタン -->
    <div class="floating-help pulse" onclick="openHelp()" title="ヘルプを開く">
        ?
    </div>

    <script>
        // グローバル変数
        let originalImage = null;
        let currentImage = new Image();
        let currentFilter = 'none';
        let tutorialStep = 0;
        let isFirstVisit = !localStorage.getItem('hasVisited');

        // チュートリアルステップ
        const tutorialSteps = [
            {
                element: '#uploadArea',
                title: 'ステップ 1: 画像のアップロード',
                text: 'まずは編集したい画像をアップロードしましょう。ドラッグ&ドロップまたはクリックで選択できます。'
            },
            {
                element: '.filter-presets',
                title: 'ステップ 2: フィルターを選択',
                text: 'プリセットフィルターから好きな効果を選んでワンクリックで適用できます。'
            },
            {
                element: '#hueSlider',
                title: 'ステップ 3: 色相の調整',
                text: 'スライダーを動かして、画像の色調を自由に変更できます。赤、青、緑など様々な色に変換可能です。'
            },
            {
                element: '.action-buttons',
                title: 'ステップ 4: 保存',
                text: '編集が完了したら、リセットで元に戻したり、ダウンロードで保存できます。'
            }
        ];

        // DOM要素の取得
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const editorContainer = document.getElementById('editorContainer');
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const newImageBtn = document.getElementById('newImageBtn');
        const resetBtn = document.getElementById('resetBtn');
        const downloadBtn = document.getElementById('downloadBtn');

        // スライダー要素
        const sliders = {
            hue: document.getElementById('hueSlider'),
            saturation: document.getElementById('saturationSlider'),
            brightness: document.getElementById('brightnessSlider'),
            contrast: document.getElementById('contrastSlider'),
            temperature: document.getElementById('temperatureSlider')
        };

        // 値表示要素
        const values = {
            hue: document.getElementById('hueValue'),
            saturation: document.getElementById('saturationValue'),
            brightness: document.getElementById('brightnessValue'),
            contrast: document.getElementById('contrastValue'),
            temperature: document.getElementById('temperatureValue')
        };

        // 初期化
        window.addEventListener('load', () => {
            if (isFirstVisit) {
                showOnboarding();
            }
            setupEventListeners();
            setupTooltips();
        });

        // オンボーディング表示
        function showOnboarding() {
            document.getElementById('onboardingModal').classList.add('active');
        }

        // オンボーディングスキップ
        function skipOnboarding() {
            document.getElementById('onboardingModal').classList.remove('active');
            localStorage.setItem('hasVisited', 'true');
            document.querySelector('.floating-help').classList.remove('pulse');
        }

        // チュートリアル開始
        function startTutorial() {
            document.getElementById('onboardingModal').classList.remove('active');
            localStorage.setItem('hasVisited', 'true');
            tutorialStep = 0;
            showTutorialStep();
        }

        // チュートリアルステップ表示
        function showTutorialStep() {
            if (tutorialStep >= tutorialSteps.length) {
                endTutorial();
                return;
            }

            const step = tutorialSteps[tutorialStep];
            const element = document.querySelector(step.element);
            
            if (element) {
                const rect = element.getBoundingClientRect();
                const highlight = document.getElementById('tutorialHighlight');
                const tooltip = document.getElementById('tutorialTooltip');
                
                // ハイライト表示
                highlight.style.display = 'block';
                highlight.style.left = rect.left - 5 + 'px';
                highlight.style.top = rect.top - 5 + 'px';
                highlight.style.width = rect.width + 10 + 'px';
                highlight.style.height = rect.height + 10 + 'px';
                
                // ツールチップ表示
                tooltip.style.display = 'block';
                tooltip.style.left = rect.right + 20 + 'px';
                tooltip.style.top = rect.top + 'px';
                
                document.getElementById('tutorialTitle').textContent = step.title;
                document.getElementById('tutorialText').textContent = step.text;
                
                document.getElementById('tutorialOverlay').classList.add('active');
            }
        }

        // 次のチュートリアルステップ
        function nextTutorialStep() {
            tutorialStep++;
            showTutorialStep();
        }

        // チュートリアルスキップ
        function skipTutorial() {
            endTutorial();
        }

        // チュートリアル終了
        function endTutorial() {
            document.getElementById('tutorialOverlay').classList.remove('active');
            document.getElementById('tutorialHighlight').style.display = 'none';
            document.getElementById('tutorialTooltip').style.display = 'none';
            document.querySelector('.floating-help').classList.remove('pulse');
        }

        // ヘルプモーダルを開く
        function openHelp() {
            document.getElementById('helpModal').classList.add('active');
            document.querySelector('.floating-help').classList.remove('pulse');
        }

        // ヘルプモーダルを閉じる
        function closeHelp() {
            document.getElementById('helpModal').classList.remove('active');
        }

        // ヘルプタブ切り替え
        function switchHelpTab(tab) {
            // タブボタンの更新
            document.querySelectorAll('.help-tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');
            
            // セクションの更新
            document.querySelectorAll('.help-section').forEach(s => s.classList.remove('active'));
            document.getElementById(tab + '-section').classList.add('active');
        }

        // FAQ開閉
        function toggleFaq(button) {
            const answer = button.nextElementSibling;
            button.classList.toggle('active');
            answer.classList.toggle('active');
        }

        // 機能ハイライト
        function highlightFeature(feature) {
            closeHelp();
            // 実際の要素にスクロールしてハイライト表示
            let element;
            switch(feature) {
                case 'upload':
                    element = uploadArea;
                    break;
                case 'adjust':
                    element = document.querySelector('.controls-panel');
                    break;
                case 'filter':
                    element = document.querySelector('.filter-presets');
                    break;
                case 'download':
                    element = downloadBtn;
                    break;
            }
            
            if (element) {
                element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                element.style.animation = 'pulse 2s';
                setTimeout(() => {
                    element.style.animation = '';
                }, 2000);
            }
        }

        // ツールチップ設定
        function setupTooltips() {
            // ヘルプアイコンのツールチップ
            document.querySelectorAll('.help-icon').forEach(icon => {
                icon.addEventListener('mouseenter', (e) => {
                    e.stopPropagation();
                    const tooltipId = icon.parentElement.querySelector('.tooltip')?.id;
                    if (tooltipId) {
                        const tooltip = document.getElementById(tooltipId);
                        if (tooltip) {
                            tooltip.classList.add('active');
                            const rect = icon.getBoundingClientRect();
                            tooltip.style.left = rect.left - tooltip.offsetWidth / 2 + 15 + 'px';
                            tooltip.style.top = rect.top - tooltip.offsetHeight - 10 + 'px';
                        }
                    }
                });
                
                icon.addEventListener('mouseleave', () => {
                    document.querySelectorAll('.tooltip').forEach(t => t.classList.remove('active'));
                });
            });
        }

        // イベントリスナー設定
        function setupEventListeners() {
            // ファイルアップロード
            uploadArea.addEventListener('click', () => fileInput.click());
            uploadArea.addEventListener('dragover', handleDragOver);
            uploadArea.addEventListener('dragleave', handleDragLeave);
            uploadArea.addEventListener('drop', handleDrop);
            fileInput.addEventListener('change', handleFileSelect);

            // ボタン
            newImageBtn.addEventListener('click', () => {
                fileInput.value = '';
                uploadArea.classList.remove('has-image');
                editorContainer.classList.remove('active');
                originalImage = null;
            });

            resetBtn.addEventListener('click', resetImage);
            downloadBtn.addEventListener('click', downloadImage);

            // スライダー
            Object.keys(sliders).forEach(key => {
                sliders[key].addEventListener('input', () => {
                    updateValueDisplay(key);
                    applyFilters();
                });
                
                // ダブルクリックでリセット
                sliders[key].addEventListener('dblclick', () => {
                    const defaults = {
                        hue: 0,
                        saturation: 100,
                        brightness: 100,
                        contrast: 100,
                        temperature: 0
                    };
                    sliders[key].value = defaults[key];
                    updateValueDisplay(key);
                    applyFilters();
                });
            });

            // フィルターボタン
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    currentFilter = btn.dataset.filter;
                    applyFilters();
                });
            });

            // キーボードショートカット
            document.addEventListener('keydown', (e) => {
                if (e.key === 'F1' || e.key === '?') {
                    e.preventDefault();
                    openHelp();
                }
                if ((e.ctrlKey || e.metaKey) && e.key === 'o') {
                    e.preventDefault();
                    fileInput.click();
                }
                if ((e.ctrlKey || e.metaKey) && e.key === 's') {
                    e.preventDefault();
                    if (originalImage) downloadImage();
                }
                if ((e.ctrlKey || e.metaKey) && e.key === 'r') {
                    e.preventDefault();
                    if (originalImage) resetImage();
                }
            });
        }

        // ドラッグ&ドロップ処理
        function handleDragOver(e) {
            e.preventDefault();
            uploadArea.classList.add('dragover');
        }

        function handleDragLeave() {
            uploadArea.classList.remove('dragover');
        }

        function handleDrop(e) {
            e.preventDefault();
            uploadArea.classList.remove('dragover');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        }

        function handleFileSelect(e) {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        }

        // ファイル処理
        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                alert('画像ファイルを選択してください');
                return;
            }

            const reader = new FileReader();
            reader.onload = (e) => {
                currentImage.onload = () => {
                    canvas.width = currentImage.width;
                    canvas.height = currentImage.height;
                    ctx.drawImage(currentImage, 0, 0);
                    
                    originalImage = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    
                    uploadArea.classList.add('has-image');
                    editorContainer.classList.add('active');
                    
                    fitCanvasToContainer();
                };
                currentImage.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        // キャンバスサイズ調整
        function fitCanvasToContainer() {
            const maxWidth = 600;
            const scale = Math.min(1, maxWidth / canvas.width);
            canvas.style.width = (canvas.width * scale) + 'px';
            canvas.style.height = (canvas.height * scale) + 'px';
        }

        // フィルター適用
        function applyFilters() {
            if (!originalImage) return;

            const imageData = ctx.createImageData(originalImage.width, originalImage.height);
            const data = imageData.data;
            const original = originalImage.data;

            const hue = parseFloat(sliders.hue.value);
            const saturation = parseFloat(sliders.saturation.value) / 100;
            const brightness = parseFloat(sliders.brightness.value) / 100;
            const contrast = parseFloat(sliders.contrast.value) / 100;
            const temperature = parseFloat(sliders.temperature.value);

            for (let i = 0; i < original.length; i += 4) {
                let r = original[i];
                let g = original[i + 1];
                let b = original[i + 2];

                // フィルター適用
                if (currentFilter !== 'none') {
                    [r, g, b] = applyFilter(r, g, b, currentFilter);
                }

                // HSL変換と調整
                let [h, s, l] = rgbToHsl(r, g, b);
                h = (h + hue + 360) % 360;
                s = Math.min(1, s * saturation);
                [r, g, b] = hslToRgb(h, s, l);

                // 明度・コントラスト調整
                r = Math.min(255, r * brightness);
                g = Math.min(255, g * brightness);
                b = Math.min(255, b * brightness);

                r = Math.min(255, Math.max(0, ((r - 128) * contrast) + 128));
                g = Math.min(255, Math.max(0, ((g - 128) * contrast) + 128));
                b = Math.min(255, Math.max(0, ((b - 128) * contrast) + 128));

                // 色温度調整
                if (temperature > 0) {
                    r = Math.min(255, r + temperature);
                    b = Math.max(0, b - temperature);
                } else {
                    r = Math.max(0, r + temperature);
                    b = Math.min(255, b - temperature);
                }

                data[i] = r;
                data[i + 1] = g;
                data[i + 2] = b;
                data[i + 3] = original[i + 3];
            }

            ctx.putImageData(imageData, 0, 0);
        }

        // フィルター効果
        function applyFilter(r, g, b, filter) {
            switch(filter) {
                case 'grayscale':
                    const gray = r * 0.299 + g * 0.587 + b * 0.114;
                    return [gray, gray, gray];
                case 'sepia':
                    return [
                        Math.min(255, (r * 0.393) + (g * 0.769) + (b * 0.189)),
                        Math.min(255, (r * 0.349) + (g * 0.686) + (b * 0.168)),
                        Math.min(255, (r * 0.272) + (g * 0.534) + (b * 0.131))
                    ];
                case 'vintage':
                    return [
                        Math.min(255, r * 1.2),
                        Math.min(255, g * 1.0),
                        Math.min(255, b * 0.8)
                    ];
                case 'cold':
                    return [r * 0.9, g, Math.min(255, b * 1.1)];
                case 'warm':
                    return [Math.min(255, r * 1.1), g, b * 0.9];
                default:
                    return [r, g, b];
            }
        }

        // RGB to HSL
        function rgbToHsl(r, g, b) {
            r /= 255;
            g /= 255;
            b /= 255;

            const max = Math.max(r, g, b);
            const min = Math.min(r, g, b);
            let h, s, l = (max + min) / 2;

            if (max === min) {
                h = s = 0;
            } else {
                const d = max - min;
                s = l > 0.5 ? d / (2 - max - min) : d / (max + min);

                switch (max) {
                    case r: h = ((g - b) / d + (g < b ? 6 : 0)) / 6; break;
                    case g: h = ((b - r) / d + 2) / 6; break;
                    case b: h = ((r - g) / d + 4) / 6; break;
                }
            }

            return [h * 360, s, l];
        }

        // HSL to RGB
        function hslToRgb(h, s, l) {
            h /= 360;
            let r, g, b;

            if (s === 0) {
                r = g = b = l;
            } else {
                const hue2rgb = (p, q, t) => {
                    if (t < 0) t += 1;
                    if (t > 1) t -= 1;
                    if (t < 1/6) return p + (q - p) * 6 * t;
                    if (t < 1/2) return q;
                    if (t < 2/3) return p + (q - p) * (2/3 - t) * 6;
                    return p;
                };

                const q = l < 0.5 ? l * (1 + s) : l + s - l * s;
                const p = 2 * l - q;

                r = hue2rgb(p, q, h + 1/3);
                g = hue2rgb(p, q, h);
                b = hue2rgb(p, q, h - 1/3);
            }

            return [Math.round(r * 255), Math.round(g * 255), Math.round(b * 255)];
        }

        // 値表示更新
        function updateValueDisplay(key) {
            const value = sliders[key].value;
            switch(key) {
                case 'hue':
                    values[key].textContent = `${value}°`;
                    break;
                case 'temperature':
                    values[key].textContent = value;
                    break;
                default:
                    values[key].textContent = `${value}%`;
            }
        }

        // リセット処理
        function resetImage() {
            sliders.hue.value = 0;
            sliders.saturation.value = 100;
            sliders.brightness.value = 100;
            sliders.contrast.value = 100;
            sliders.temperature.value = 0;

            Object.keys(sliders).forEach(key => updateValueDisplay(key));
            
            currentFilter = 'none';
            document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
            document.querySelector('[data-filter="none"]').classList.add('active');
            
            if (originalImage) {
                ctx.putImageData(originalImage, 0, 0);
            }
        }

        // ダウンロード処理
        function downloadImage() {
            const link = document.createElement('a');
            link.download = 'edited-image.png';
            link.href = canvas.toDataURL();
            link.click();
        }

        // 個別ヘルプ表示関数
        function showUploadHelp(e) {
            e.stopPropagation();
        }

        function showPreviewHelp(e) {
            e.stopPropagation();
        }

        function showControlsHelp(e) {
            e.stopPropagation();
        }

        function showResetHelp(e) {
            e.stopPropagation();
            alert('すべての編集をリセットして元の画像に戻します');
        }

        function showDownloadHelp(e) {
            e.stopPropagation();
            alert('編集した画像をPNG形式でダウンロードします');
        }
    </script>
</body>
</html>